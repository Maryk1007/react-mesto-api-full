{"ast":null,"code":"import _toConsumableArray from\"/Users/ivanlapsov/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/ivanlapsov/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{api}from\"../utils/api.js\";import Header from\"./Header.js\";import Main from\"./Main.js\";import Footer from\"./Footer.js\";import EditProfilePopup from\"./EditProfilePopup.js\";import AddPlacePopup from\"./AddPlacePopup.js\";import EditAvatarPopup from\"./EditAvatarPopup.js\";import ConfirmDeletePopup from\"./ConfirmDeletePopup.js\";import ImagePopup from\"./ImagePopup.js\";import{CurrentUserContext}from\"../contexts/CurrentUserContext.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),currentUser=_React$useState2[0],setCurrentUser=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),cards=_React$useState4[0],setCards=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isPopupProfileOpen=_React$useState6[0],setIsPopupProfileOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isPopupPhotoOpen=_React$useState8[0],setIsPopupPhotoOpen=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isPopupAvatarOpen=_React$useState10[0],setIsPopupAvatarOpen=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),isPopupConfirmDelete=_React$useState12[0],setIsPopupConfirmDelete=_React$useState12[1];var _React$useState13=React.useState({}),_React$useState14=_slicedToArray(_React$useState13,2),selectCard=_React$useState14[0],setSelectCard=_React$useState14[1];var _React$useState15=React.useState({}),_React$useState16=_slicedToArray(_React$useState15,2),cardDelete=_React$useState16[0],setCardDelete=_React$useState16[1];React.useEffect(function(){Promise.all([api.getProfile(),api.getCardItems()]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),res=_ref2[0],cards=_ref2[1];setCurrentUser(res);setCards(cards);}).catch(function(err){console.log(err);});},[]);function handleUpdateUser(updateUser){api.editProfile(updateUser.name,updateUser.about).then(function(res){setCurrentUser(res);setIsPopupProfileOpen(false);}).catch(function(err){console.log(err);}).finally(function(){updateUser.onRenderLoading(false);});}function handleAddPlaceSubmit(newCard){api.addCards(newCard.name,newCard.link).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));setIsPopupPhotoOpen(false);}).catch(function(err){console.log(err);}).finally(function(){newCard.onRenderLoading(false);});}function handleUpdateAvatar(updateAvatar){api.editAvatar(updateAvatar.avatar).then(function(res){setCurrentUser(res);setIsPopupAvatarOpen(false);}).catch(function(err){console.log(err);}).finally(function(){updateAvatar.onRenderLoading(false);});}function handleEditProfileClick(){setIsPopupProfileOpen(true);}function handleAddPlaceClick(){setIsPopupPhotoOpen(true);}function handleEditAvatarClick(){setIsPopupAvatarOpen(true);}function closeAllPopups(){setIsPopupProfileOpen(false);setIsPopupPhotoOpen(false);setIsPopupAvatarOpen(false);setIsPopupConfirmDelete(false);setSelectCard({});}function handleCardClick(card){setSelectCard(card);}function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});if(!isLiked){api.addLike(card._id).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(console.log);}else{api.deleteLike(card._id).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(console.log);}}function handleDeleteClick(card){setIsPopupConfirmDelete(true);setCardDelete(card);}function handleCardDelete(obj){api.deleteCard(cardDelete._id).then(function(res){setCards(function(cards){return cards.filter(function(c){return c._id!==cardDelete._id;});});setIsPopupConfirmDelete(false);}).catch(console.log).finally(function(){obj.onRenderLoading(false);});}return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{cards:cards,onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,onCardLike:handleCardLike,onCardDelete:handleDeleteClick}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isPopupProfileOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isPopupAvatarOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isPopupPhotoOpen,onClose:closeAllPopups,onUpdatePhoto:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(ConfirmDeletePopup,{isOpen:isPopupConfirmDelete,onClose:closeAllPopups,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(ImagePopup,{card:selectCard,onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"names":["React","api","Header","Main","Footer","EditProfilePopup","AddPlacePopup","EditAvatarPopup","ConfirmDeletePopup","ImagePopup","CurrentUserContext","App","useState","currentUser","setCurrentUser","cards","setCards","isPopupProfileOpen","setIsPopupProfileOpen","isPopupPhotoOpen","setIsPopupPhotoOpen","isPopupAvatarOpen","setIsPopupAvatarOpen","isPopupConfirmDelete","setIsPopupConfirmDelete","selectCard","setSelectCard","cardDelete","setCardDelete","useEffect","Promise","all","getProfile","getCardItems","then","res","catch","err","console","log","handleUpdateUser","updateUser","editProfile","name","about","finally","onRenderLoading","handleAddPlaceSubmit","newCard","addCards","link","handleUpdateAvatar","updateAvatar","editAvatar","avatar","handleEditProfileClick","handleAddPlaceClick","handleEditAvatarClick","closeAllPopups","handleCardClick","card","handleCardLike","isLiked","likes","some","i","_id","addLike","state","map","c","deleteLike","handleDeleteClick","handleCardDelete","obj","deleteCard","filter"],"sources":["/Users/ivanlapsov/dev/mesto-react/src/components/App.js"],"sourcesContent":["import React from \"react\";\nimport { api } from \"../utils/api.js\";\nimport Header from \"./Header.js\";\nimport Main from \"./Main.js\";\nimport Footer from \"./Footer.js\";\nimport EditProfilePopup from \"./EditProfilePopup.js\";\nimport AddPlacePopup from \"./AddPlacePopup.js\";\nimport EditAvatarPopup from \"./EditAvatarPopup.js\";\nimport ConfirmDeletePopup from \"./ConfirmDeletePopup.js\";\nimport ImagePopup from \"./ImagePopup.js\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext.js\";\n\nfunction App() {\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [cards, setCards] = React.useState([]);\n  const [isPopupProfileOpen, setIsPopupProfileOpen] = React.useState(false);\n  const [isPopupPhotoOpen, setIsPopupPhotoOpen] = React.useState(false);\n  const [isPopupAvatarOpen, setIsPopupAvatarOpen] = React.useState(false);\n  const [isPopupConfirmDelete, setIsPopupConfirmDelete] = React.useState(false);\n  const [selectCard, setSelectCard] = React.useState({});\n  const [cardDelete, setCardDelete] = React.useState({});\n\n  React.useEffect(() => {\n    Promise.all([api.getProfile(), api.getCardItems()])\n      .then(([res, cards]) => {\n        setCurrentUser(res);\n        setCards(cards);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  function handleUpdateUser(updateUser) {\n    api\n      .editProfile(updateUser.name, updateUser.about)\n      .then((res) => {\n        setCurrentUser(res);\n        setIsPopupProfileOpen(false);\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n      .finally(() => {\n        updateUser.onRenderLoading(false);\n      });\n  }\n\n  function handleAddPlaceSubmit(newCard) {\n    api\n      .addCards(newCard.name, newCard.link)\n      .then((newCard) => {\n        setCards([newCard, ...cards]);\n        setIsPopupPhotoOpen(false);\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n      .finally(() => {\n        newCard.onRenderLoading(false);\n      });\n  }\n\n  function handleUpdateAvatar(updateAvatar) {\n    api\n      .editAvatar(updateAvatar.avatar)\n      .then((res) => {\n        setCurrentUser(res);\n        setIsPopupAvatarOpen(false);\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n      .finally(() => {\n        updateAvatar.onRenderLoading(false);\n      });\n  }\n\n  function handleEditProfileClick() {\n    setIsPopupProfileOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsPopupPhotoOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsPopupAvatarOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsPopupProfileOpen(false);\n    setIsPopupPhotoOpen(false);\n    setIsPopupAvatarOpen(false);\n    setIsPopupConfirmDelete(false);\n    setSelectCard({});\n  }\n\n  function handleCardClick(card) {\n    setSelectCard(card);\n  }\n\n  function handleCardLike(card) {\n    const isLiked = card.likes.some((i) => i._id === currentUser._id);\n\n    if (!isLiked) {\n      api\n        .addLike(card._id)\n        .then((newCard) => {\n          setCards((state) =>\n            state.map((c) => (c._id === card._id ? newCard : c))\n          );\n        })\n        .catch(console.log);\n    } else {\n      api\n        .deleteLike(card._id)\n        .then((newCard) => {\n          setCards((state) =>\n            state.map((c) => (c._id === card._id ? newCard : c))\n          );\n        })\n        .catch(console.log);\n    }\n  }\n\n  function handleDeleteClick(card) {\n    setIsPopupConfirmDelete(true);\n    setCardDelete(card);\n  }\n\n  function handleCardDelete(obj) {\n    api\n      .deleteCard(cardDelete._id)\n      .then((res) => {\n        setCards((cards) => cards.filter((c) => c._id !== cardDelete._id));\n        setIsPopupConfirmDelete(false);\n      })\n      .catch(console.log)\n      .finally(() => {\n        obj.onRenderLoading(false);\n      });\n  }\n\n  return (\n    <div className=\"page\">\n      <CurrentUserContext.Provider value={currentUser}>\n        <Header />\n        <Main\n          cards={cards}\n          onEditProfile={handleEditProfileClick}\n          onAddPlace={handleAddPlaceClick}\n          onEditAvatar={handleEditAvatarClick}\n          onCardClick={handleCardClick}\n          onCardLike={handleCardLike}\n          onCardDelete={handleDeleteClick}\n        />\n        <Footer />\n        <EditProfilePopup\n          isOpen={isPopupProfileOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n        />\n        <EditAvatarPopup\n          isOpen={isPopupAvatarOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n        />\n        <AddPlacePopup\n          isOpen={isPopupPhotoOpen}\n          onClose={closeAllPopups}\n          onUpdatePhoto={handleAddPlaceSubmit}\n        />\n        <ConfirmDeletePopup\n          isOpen={isPopupConfirmDelete}\n          onClose={closeAllPopups}\n          onCardDelete={handleCardDelete}\n        />\n        <ImagePopup card={selectCard} onClose={closeAllPopups} />\n      </CurrentUserContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}